#+TITLE: Notmuch layer

[[file:notmuch-logo.png]]

* Table of Contents                                         :TOC_4_gh:noexport:
- [[#install][Install]]
  - [[#sending-and-receiving-emails][Sending and Receiving emails]]
    - [[#receiving-emails][Receiving emails]]
      - [[#how-to-configure-for-example-mbsync][how to configure for example mbsync]]
    - [[#sending-emails-with-thunderbird][Sending emails with Thunderbird]]
    - [[#sending-emails-with-msmtp][Sending emails with msmtp]]
- [[#commands][Commands]]
  - [[#global-bindings][Global bindings]]
  - [[#hello-mode][Hello mode]]
      - [[#evilified-state][Evilified state]]
  - [[#search-mode][Search mode]]
      - [[#evilified-state-1][Evilified state]]
      - [[#visual-state][Visual state]]
  - [[#tree-mode][Tree mode]]
      - [[#evilified-state-2][Evilified state]]
  - [[#show-mode][Show mode]]
      - [[#evilified-state-3][Evilified state]]
- [[#see-also][See also]]

* Install
In order to use this layer you must install notmuch separately.

To install not much follow the instructions in [[https://notmuchmail.org/notmuch-emacs/#index2h2][installation instructions]].


Then add this layer to your =~/.spacemacs=. You will need to add =notmuch= to
the existing =dotspacemacs-configuration-layers= list in this file.

** Sending and Receiving emails
For this you will need an external program.

*** Receiving emails
To be able to receive email you will need to configure an external program to do
it. See the [[https://notmuchmail.org/howto/][receive mail]] section.


After you configured your email fetcher program, maybe you would like to
synchronize the email each time you call =notmuch=, in order to do that you
could customize the variable =notmuch-hello-mode-hook= to call a lisp function
that calls your email syncing utility.

**** how to configure for example mbsync

=TODO=


*** Sending emails with Thunderbird
You could use thunderbird
http://pragmaticemacs.com/emacs/use-emacs-for-thunderbird-emails/

*** Sending emails with msmtp

Download and Install [[http://msmtp.sourceforge.net/download.html][msmtp]]

Configure =~/.mailrc= with the path where =msmtp= is found.

For example:
#+srcname: contents of ~/.mailrc
#+BEGIN_SRC
set sendmail="/usr/local/bin/msmtp"
#+END_SRC

Configure =~/.msmtprc= [[http://msmtp.sourceforge.net/doc/msmtprc.txt][example]]

* Commands

** Global bindings

| Keybinding  | Command            |
|-------------+--------------------|
| ~SPC a N N~ | Start notmuch      |
| ~SPC a N n~ | Start helm notmuch |

** Hello mode

**** Evilified state
| Keybinding | Command                           |
|------------+-----------------------------------|
| ~J~        | notmuch-jump-search               |
| ~s~        | notmuch-search                    |
| ~S~        | helm-notmuch (interactive search) |

** Search mode

**** Evilified state
| Keybinding | Command                        |
|------------+--------------------------------|
| ~J~        | notmuch-jump-search            |
| ~N~        | notmuch-show-next-message      |
| ~n~        | notmuch-show-next-open-message |
| ~T~        | spacemacs/notmuch-trash-show   |

**** Visual state
| Keybinding | Command                                 |
|------------+-----------------------------------------|
| ~*~        | notmuch-search-tag-all                  |
| ~+~        | notmuch-search-add-tag                  |
| ~-~        | notmuch-search-remove-tag               |
| ~a~        | notmuch-search-archive-thread           |

** Tree mode
**** Evilified state
| Keybinding | Command |
|------------+---------|
|            |         |

** Show mode


| Keybinding      | Command                                  |
|-----------------+------------------------------------------|
| ~SPC m a~       | notmuch-show-save-attachments            |
|-----------------+------------------------------------------|
| ~SPC m p m~     | notmuch-show-choose-mime-of-part         |
| ~SPC m p \vert~ | notmuch-show-pipe-part                   |
| ~SPC m p o~     | notmuch-show-interactively-view-part     |
| ~SPC m p v~     | notmuch-show-view-part                   |
| ~SPC m p s~     | notmuch-show-save-part                   |
|-----------------+------------------------------------------|
| ~SPC m s G~     | notmuch-show-stash-git-send-email        |
| ~SPC m s L~     | notmuch-show-stash-mlarchive-link-and-go |
| ~SPC m s l~     | notmuch-show-stash-mlarchive-link        |
| ~SPC m s t~     | notmuch-show-stash-to                    |
| ~SPC m s T~     | notmuch-show-stash-tags                  |
| ~SPC m s s~     | notmuch-show-stash-subject               |
| ~SPC m s I~     | notmuch-show-stash-message-id-stripped   |
| ~SPC m s i~     | notmuch-show-stash-message-id            |
| ~SPC m s f~     | notmuch-show-stash-from                  |
| ~SPC m s F~     | notmuch-show-stash-filename              |
| ~SPC m s d~     | notmuch-show-stash-date                  |
| ~SPC m s c~     | notmuch-show-stash-cc                    |

**** Evilified state

| Keybinding | Description                       |
|------------+-----------------------------------|
| ~o~        | Open all messages                 |
| ~O~        | Close all messages                |
| ~n~        | Show next open message            |
| ~N~        | Show next message                 |
| ~p~        | Show previous open message        |
| ~P~        | Show previous message             |
| ~C-n~      | Show next thread                  |
| ~C-p~      | Show previous thread              |
| ~d~        | Delete messages down              |
| ~D~        | Delete messages up                |
| ~J~        | Jump search                       |
| ~L~        | Filter current search             |
| ~gf~       | Find file or URL at point         |
| ~gg~       | Jump to top                       |
| ~G~        | Jump to bottom                    |
| ~gr~       | Refresh buffer                    |
| ~gR~       | Refresh all buffers               |
| ~S~        | helm-notmuch (interactive search) |
| ~m~        | Compose mail                      |


* See also
Refer to the official notmuch website for more information.

- https://notmuchmail.org/
